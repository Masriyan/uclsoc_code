# 1. Execution of Malicious Processes (Living off the Land - LOLBins)
def detect_malicious_process(process_logs, lolbin_list):
    for process in process_logs:
        if process['name'] in lolbin_list:
            alert(f"Potential LOLBins execution detected: {process['name']}")

# 2. Ransomware Behavior Detection (File Encryption, Volume Shadow Copy Deletion)
def detect_ransomware(file_operations):
    for operation in file_operations:
        if operation['action'] == 'encrypt' or 'vssadmin delete shadows' in operation['command']:
            alert(f"Ransomware behavior detected: {operation['file']}")

# 3. Persistence Mechanisms (Registry, Startup Folder, Scheduled Tasks)
def detect_persistence(registry_changes, startup_modifications, scheduled_tasks):
    for change in registry_changes:
        if change['key'] in PERSISTENCE_KEYS:
            alert(f"Registry persistence detected: {change['key']}")
    for task in scheduled_tasks:
        alert(f"Scheduled task persistence detected: {task['name']}")

# 4. Unusual PowerShell, CMD, or Bash Execution
def detect_suspicious_script(script_logs):
    for script in script_logs:
        if script['command'] in SUSPICIOUS_COMMANDS:
            alert(f"Suspicious script detected: {script['command']}")

# 5. Mass File Deletion or Modification
def detect_mass_file_changes(file_changes):
    user_changes = {}
    for change in file_changes:
        user = change['user']
        user_changes[user] = user_changes.get(user, 0) + 1
        if user_changes[user] > MASS_DELETION_THRESHOLD:
            alert(f"Mass file deletion detected by {user}")

# 6. Unauthorized Portable Device Usage (USB, External HDD, etc.)
def detect_usb_usage(device_logs):
    for device in device_logs:
        if device['type'] == 'USB' and device['status'] == 'connected':
            alert(f"Unauthorized USB device detected: {device['device_id']}")

# 7. Credential Dumping Attempts (Mimikatz, LSASS Access)
def detect_credential_dumping(process_logs):
    for process in process_logs:
        if process['name'] in ['mimikatz.exe', 'procdump.exe', 'lsass.exe']:
            alert(f"Credential dumping attempt detected: {process['name']}")

# 8. Malicious DLL Injection & Process Hollowing
def detect_dll_injection(process_events):
    for event in process_events:
        if event['type'] == 'DLL Injection':
            alert(f"DLL Injection detected in {event['target_process']}")

# 9. Beaconing or C2 (Command & Control) Activity Detection
def detect_beaconing(network_traffic):
    for traffic in network_traffic:
        if traffic['interval'] < C2_THRESHOLD:
            alert(f"Potential C2 beaconing detected: {traffic['destination_ip']}")

# 10. Unusual Scripting Language Usage (PowerShell, Python, etc.)
def detect_unusual_scripting(script_logs):
    for script in script_logs:
        if script['language'] in ['Python', 'PowerShell']:
            alert(f"Unusual scripting detected: {script['command']}")